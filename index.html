<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <title>Song Player</title>
    <style>
      html, body { height: 100%; margin: 0; background: #0b0b0b; color: #f5f5f5; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol; }
      .wrap { height: 100%; display: flex; justify-content: center; align-items: center; padding: 20px; }
      .songs-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; max-width: 1000px; width: 100%; }
      .song-card { background: #1a1a1a; border-radius: 12px; padding: 16px; text-align: center; cursor: pointer; transition: transform .1s ease, background .2s ease; border: 2px solid transparent; }
      .song-card:hover { background: #222; }
      .song-card.active { border-color: #3a86ff; }
      .song-title { font-size: 16px; margin: 12px 0 0; font-weight: 500; }
      button { appearance: none; background: #1f1f1f; color: #fff; border: 1px solid #2e2e2e; border-radius: 9999px; padding: 14px 22px; font-size: 16px; cursor: pointer; box-shadow: 0 0 0 3px rgba(255,255,255,0.05) inset; transition: transform .05s ease, background .2s ease, box-shadow .2s ease; }
      button:hover { background: #2a2a2a; }
      button:active { transform: scale(0.98); }
      .hint { margin-top: 12px; opacity: .7; font-size: 14px; text-align: center; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div style="width: 100%; max-width: 1000px;">
        <div class="songs-grid" id="songs-grid"></div>
      </div>
    </div>

    <div id="media-container" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center;">
      <div style="position: relative; width: 80%; max-width: 1200px;">
        <button id="close-video" style="position: absolute; top: -40px; right: 0; background: #ff3b3b; border: none;">Close</button>
        <video id="video-player" controls style="width: 100%; display: none;"></video>
      </div>
    </div>
    
    <audio id="player" preload="auto" loop></audio>

    <script>
      const songs = [
        { title: "èˆ¹ç¥¨", src: "./public/song.mp3" },
        { title: "Crying", src: "./public/SaveTik.co_7505711974253874489.mp3" },
        { title: "Blue (slowed)", src: "./public/blue (slowed down) [jnL6PJM5TNo].mp3" },
        { title: "Ð½Ð¾ÑÑ‚Ð°Ð»ÑŒÐ³Ð¸Ñ", src: "./public/russiansong.MP3" },
        { title: "Slowed Down", src: "./public/Slow Down 0.8 Madnap [HiJHuRWj0jw].mp3" },
        { title: "Sacred Play Secret Place", src: "./public/Sacred Play Secret Place [XX2gPs44fxg].mp3" },
        { title: "Stereo Love & Danza Kuduro", src: "./public/Stereo Love x Danza Kuduro ï½œ Edward Maya x Don Omar, Lucenzo ï½œ Jimmy Dalby Mashup [QOxM2_7D5xs].mp3" },
        { title: "When It Feels Scary, That's When You Jump", src: "./public/Oscar Isaac - When It Feels Scary, That's When You Jump.mp3" },
        { title: "Stereo Love (Radio Edit)", src: "./public/Edward Maya, Vika Jigulina - Stereo love (Radio Edit) (Lyrics) 4.mp3" },
        { title: "Every Breath You Take", src: "./public/The Police - Every Breath You Take (Official Music Video) 4.mp3" },
        { title: "Say the Beat", src: "./public/1217 (1).MP3" },
        { title: "People", src: "./public/Mac Miller - People 4.mp3" },
        { title: "Thank You", src: "./public/Dido - Thank You (Lyrics) 4.mp3" },
        { title: "DtMF", src: "./public/BAD BUNNY - DtMF (Lyrics Spanish & English) 4.mp3" },
        { title: "In This Shirt", src: "./public/In This Shirt.mp3" }
      ];
      let currentSongIndex = 0;
      // Track clicks for double-tap detection
      let lastClickTime = 0;
      let lastClickedIndex = -1;
      const songsGrid = document.getElementById('songs-grid');
      const player = document.getElementById('player');
      let started = false;

      function isVideoFile(filename) {
        return filename.toLowerCase().endsWith('.mp4') || 
               filename.toLowerCase().endsWith('.webm') || 
               filename.toLowerCase().endsWith('.mov');
      }

      function loadSong(index) {
        currentSongIndex = index;
        const src = songs[currentSongIndex].src;
        const isVideo = isVideoFile(src);
        
        if (isVideo) {
          // For video files
          const videoPlayer = document.getElementById('video-player');
          const mediaContainer = document.getElementById('media-container');
          
          player.pause();
          player.src = '';
          
          videoPlayer.src = src;
          videoPlayer.style.display = 'block';
          mediaContainer.style.display = 'flex';
        } else {
          // For audio files
          const videoPlayer = document.getElementById('video-player');
          const mediaContainer = document.getElementById('media-container');
          
          if (videoPlayer.src) {
            videoPlayer.pause();
            videoPlayer.src = '';
          }
          
          videoPlayer.style.display = 'none';
          mediaContainer.style.display = 'none';
          player.src = src;
        }
        
        // Update active song in the grid
        document.querySelectorAll('.song-card').forEach((card, i) => {
          if (i === currentSongIndex) {
            card.classList.add('active');
          } else {
            card.classList.remove('active');
          }
        });
      }

      async function startPlayback() {
        if (!player.src && !document.getElementById('video-player').src) loadSong(currentSongIndex);
        
        try {
          if (isVideoFile(songs[currentSongIndex].src)) {
            await document.getElementById('video-player').play();
          } else {
            await player.play();
          }
          started = true;
        } catch (e) {
          console.error('Failed to play:', e);
        }
      }

      // Try to resume if tab regains focus or after user interactions
      const resume = async () => {
        if (!started) return;
        
        if (isVideoFile(songs[currentSongIndex].src)) {
          const videoPlayer = document.getElementById('video-player');
          if (videoPlayer.paused && document.getElementById('media-container').style.display === 'flex') {
            try { await videoPlayer.play(); } catch {}
          }
        } else if (player.paused) {
          try { await player.play(); } catch {}
        }
      };
      window.addEventListener('focus', resume);
      document.addEventListener('visibilitychange', resume);

      // Create song cards
      songs.forEach((song, index) => {
        const card = document.createElement('div');
        card.className = 'song-card';
        if (index === currentSongIndex) card.classList.add('active');
        
        const isVideo = isVideoFile(song.src);
        card.innerHTML = `
          <div class="song-icon" style="font-size: 32px;">${isVideo ? 'ðŸŽ¬' : 'ðŸŽµ'}</div>
          <div class="song-title">${song.title}</div>
        `;
        
        card.addEventListener('click', async () => {
          const now = new Date().getTime();
          const timeSinceLastClick = now - lastClickTime;
          
          // Load the song if it's not the current one
          if (index !== currentSongIndex) {
            loadSong(index);
          }
          
          // Double-tap detection (within 300ms)
          if (timeSinceLastClick < 300 && lastClickedIndex === index) {
            // Double-tap - play the song/video
            const isVideo = isVideoFile(songs[index].src);
            const videoPlayer = document.getElementById('video-player');
            
            if (isVideo) {
              if (videoPlayer.paused) {
                if (!started) {
                  await startPlayback();
                } else {
                  await videoPlayer.play();
                }
              }
            } else {
              if (player.paused) {
                if (!started) {
                  await startPlayback();
                } else {
                  await player.play();
                }
              }
            }
          } else if (currentSongIndex === index) {
            // Single-tap on playing song/video - pause it
            const isVideo = isVideoFile(songs[index].src);
            if (isVideo) {
              const videoPlayer = document.getElementById('video-player');
              if (!videoPlayer.paused) {
                videoPlayer.pause();
              }
            } else {
              if (!player.paused) {
                player.pause();
              }
            }
          }
          
          // Update tracking variables
          lastClickTime = now;
          lastClickedIndex = index;
        });
        
        songsGrid.appendChild(card);
      });
      
      // Close video button
      document.getElementById('close-video').addEventListener('click', () => {
        const videoPlayer = document.getElementById('video-player');
        const mediaContainer = document.getElementById('media-container');
        
        if (videoPlayer.src) {
          videoPlayer.pause();
        }
        
        mediaContainer.style.display = 'none';
      });
      
      // Initialize the first song
      loadSong(0);
    </script>
  </body>
</html>

